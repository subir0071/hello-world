name: Install winget-create on all Windows runners

on:
  workflow_dispatch:

jobs:
  install-winget-create:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os:
          - windows-2019
          - windows-2022
          - windows-2025

    steps:
    - name: Checkout repo
      uses: actions/checkout@v4

    - name: Install winget-create
      shell: pwsh
      run: |
        choco install wingetcreate -y

    - name: Check wingetcreate install
      shell: pwsh
      run: |
        choco list --local-only
        Get-ChildItem "C:\ProgramData\chocolatey\lib\wingetcreate" -Recurse

    - name: Verify winget-create installation
      run: wingetcreate --version --verbose-logs
